FROM jboss/keycloak:8.0.1
LABEL MAINTAINER="Mark Thomsit <mark@makeandship.com>"

USER root
ADD mykrobe-atlas-themes.tar.gz /opt/jboss/keycloak/themes/
RUN ls -la /opt/jboss/keycloak/themes/ && tar -zxvf /opt/jboss/keycloak/themes/mykrobe-atlas-themes.tar.gz --directory /opt/jboss/keycloak/themes
USER 1000

# turn off theme caching
RUN sed -i 's#<cacheThemes>true</cacheThemes>#<cacheThemes>false</cacheThemes>#g' /opt/jboss/keycloak/standalone/configuration/standalone.xml
RUN sed -i 's#<cacheTemplates>true</cacheTemplates>#<cacheTemplates>false</cacheTemplates>#g' /opt/jboss/keycloak/standalone/configuration/standalone.xml
